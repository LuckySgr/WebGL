# 一、WebGL基础概念

1、WebGL仅仅是一个光栅化引擎，它可以根据你的代码绘制出点，线和三角形。通过组合使用点，线和三角形，可以实现复杂、炫酷的场景。

2、WebGL在电脑的GPU中运行。因此你需要使用能够在GPU上运行的代码。

这样的代码需要提供成对的方法。 每对方法中一个叫顶点着色器， 另一个叫片段着色器，并且使用一种和C或C++类似的强类型的语言 GLSL。

(GL着色语言)。 每一对组合起来称作一个 program（着色程序）。

3、着色器的分类及作用 

着色器分为**顶点着色器**、**片段着色器**。 

顶点着色器的作用是计算顶点的位置。根据计算出的一系列顶点位置，WebGL可以对点， 线和三角形在内的一些图元进行光栅化处理。当对这些图元进行光栅化处理时需要使用片段着色器方法。 

片段着色器的作用是计算出当前绘制图元中每个像素的颜色值。

4、几乎整个WebGL API都是关于如何设置这些成对方法的状态值以及运行它们。

对于想要绘制的每一个对象，都需要先设置一系列状态值，然后通过调用 `gl.drawArrays` 或 `gl.drawElements` 运行一个着色方法对，使得着色器对能够在GPU上运行。

5、这些方法对所需的任何数据都需要发送到GPU，这里有着色器获取数据的4种方法。

**5.1 属性（Attributes）和缓冲**

缓冲是发送到GPU的一些二进制数据序列，通常情况下缓冲数据包括位置，法向量，纹理坐标，顶点颜色值等。 你可以存储任何数据。

属性用来指明怎么从缓冲中获取所需数据并将它提供给顶点着色器。 例如你可能在缓冲中用三个32位的浮点型数据存储一个位置值。 对于一个确切的属性你需要告诉它从哪个缓冲中获取数据，获取什么类型的数据（三个32位的浮点数据）， 起始偏移值是多少，到下一个位置的字节数是多少。

缓冲不是随意读取的。事实上顶点着色器运行的次数是一个指定的确切数字， 每一次运行属性会从指定的缓冲中按照指定规则依次获取下一个值。

**5.2 全局变量（Uniforms）**

全局变量在着色程序运行前赋值，在运行过程中全局有效。

**5.3 纹理（Textures）**

纹理是一个数据序列，可以在着色程序运行中随意读取其中的数据。 大多数情况存放的是图像数据，但是纹理仅仅是数据序列， 你也可以随意存放除了颜色数据以外的其它数据。

**5.4 可变量（Varyings）**

可变量是一种顶点着色器给片段着色器传值的方式，依照渲染的图元是点， 线还是三角形，顶点着色器中设置的可变量会在片段着色器运行中获取不同的插值。

**总结**

WebGL只关心两件事：裁剪空间中的坐标值和颜色值。使用WebGL只需要给它提供这两个东西。 你需要提供两个着色器来做这两件事，一个顶点着色器提供裁剪空间坐标值，一个片段着色器提供颜色值。

无论你的画布有多大，裁剪空间的坐标范围永远是 -1 到 1 。

# 二、部分API解释

1、getAttribLocation 与 vertexAttribPointer

getAttribLocation：用于获取着色器中声明的变量。

vertexAttribPointer：用于对获取到的变量进行赋值。

如：

let aposLocation = gl.getAttribLocation(program,‘apos’);

gl.vertexAttribPointer(aposLocation,2,gl.FLOAT,false,0,0);

以上代码第一行用于获取着色器变量对象

第二行用于将缓冲区数据传给着色器对象

其中缓冲区数据传递代码如下:

let buffer=gl.createBuffer();

gl.bindBuffer(gl.ARRAY_BUFFER,buffer);

gl.bufferData(gl.ARRAY_BUFFER,data,gl.STATIC_DRAW);

第一行用于创建一个缓冲区

第二行用于关联某一个缓冲区

第三行用于将data数据传给绑定的缓冲区

之所以要弄这种先创建缓冲区然后再绑定某一个缓冲区的方式，是为了可以创建多个缓冲区，然后绑定特定的缓冲区。

以上整个过程为以缓冲区为中间容器，先将外部数据传到缓冲区，然后将缓冲区数据传到内部着色器变量